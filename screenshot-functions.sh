winid=${winid:-"$(xdotool getwindowfocus -f)"}
. ~/.profile
. ~/.bashrc
screenshot() {
    out="$1"
    shift
    clear
    temp=`mktemp`
    echo -e "${red}bash-4.3#$nc $@" | tee "$temp"
    "$@" |& tee --append "$temp" |& head -70
    declare -i sz=`awk 'END {print NR}' "$temp"`
    sz=$(((sz+4)*16))
    mv "$temp" "$out.spl"
    import -window "$winid" -crop "800x$sz+12+14" "$out.png"
}

reshoot() {
    out="$1"
    clear
    cat "$out.spl"
    declare -i sz=`awk 'END {print NR}' "$out.spl"`
    sz=$(((sz+4)*16))
    import -window "$winid" -crop "800x$sz+12+14" "$out.png"
}

screenshot_named() {
    out="$1"
    shift
    clear
    echo -e "${red}bash-4.3#$nc $@" | tee "$out.spl"
    "$@" |& tee --append "$out.spl" 
    declare -i sz=`awk 'END {print NR}' "$out.spl"`
    sz=$(((sz+4)*16))
    import -window "$winid" -crop "800x$sz+12+14" "$out.png"
}

screenshot_plus() {
    out="$1"
    declare -i add="$2"
    shift 2
    clear
    temp=`mktemp`
    echo -e "${red}bash-4.3#$nc $@" | tee "$temp"
    "$@" |& tee --append "$temp" |& head -70
    declare -i sz=`awk 'END {print NR}' "$temp"`
    sz=$(((sz+add)*16))
    mv "$temp" "$out.spl"
    import -window "$winid" -crop "800x$sz+12+14" "$out.png"
}

screenshot_multi() {
    out="$1"
    shift
    clear
    declare -i sz=0
    echo -n > "$out.spl"
    for cmd in "$@"; do
        echo -e "${red}bash-4.3#$nc ${cmd//\\/\\\\}" | tee --append "$out.spl"
        bash -c "$cmd" |& tee --append "$out.spl" |& head -70
    done
    declare -i sz=`awk 'END {print NR}' "$out.spl"`
    sz=$(((sz+4)*16))
    import -window "$winid" -crop "800x$sz+12+14" "$out.png"
    read
    return 0
}
