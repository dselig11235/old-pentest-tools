#!/bin/bash

. ~/bin/screenshot-functions.sh
screenweb() {
    local target="$1"
    local name="$2"
    webview "$target" &
    local pid=$!
    sleep 1
    local winid=`winfrompid $pid`
    zenity --info --text "resize web page to fit contents"
    import -window $winid "$name"
    kill $pid
}


for target in `cat targets.web`; do
    cleaned=${target//:\/\//_}
    screenweb "$target" "Manual Navigation to $cleaned.png" 
#    (
#        webview "$target" &
#        name="manual navigation to ${target//:\/\//_}"
#        pid=$!
#        #zenity --info --text "close when web page is finished loading"
#        sleep 15
#        import -window `winfrompid $pid` "$name.png"
#        kill $pid
#    ) &
done
for target in `cat targets.web`; do
    cleaned=${target//:\/\//_}
    screenshot_plus "Directory Enumeration of $cleaned.png" 8\
        dirb "$target" <(shuf $HOME/tools/DirBuster-Lists/user-plus-directory-small.txt | head -1000) -X .asp,.aspx,.php -o "Directory Enumeration of $cleaned.txt" || true
done
